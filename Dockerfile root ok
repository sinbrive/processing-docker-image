FROM ubuntu:22.04

ENV DISPLAY=:0
ENV HOME=/home
ENV PYTHONMODE /home/app/sketchbook/modes

RUN apt-get update && apt-get install -y openjdk-21-jdk unzip wget 

# Download and install Processing
RUN wget http://github.com/processing/processing4/releases/download/processing-1304-4.4.4/processing-4.4.4-linux-x64-portable.zip \
    && unzip processing-4.4.4-linux-x64-portable.zip -d /opt \
    && ln -s /opt/Processing/bin/Processing /usr/local/bin/processing \
    && rm processing-4.4.4-linux-x64-portable.zip 

# create non-root user 
# RUN useradd --home-dir $HOME pyuser \
#     && mkdir -p /home/my_sketches  \
#     && chown -R pyuser:pyuser /home/my_sketches
      
RUN mkdir -p /home/my_sketches

# RUN useradd -ms /bin/bash pyuser 
    #    && chown -R pyuser:pyuser $HOME 

# Set the working directory in the container
WORKDIR /home/my_sketches
# COPY ./PythonMode ./sketchbook/modes

# switch to new user
# USER pyuser  

CMD ["/usr/local/bin/processing"]




